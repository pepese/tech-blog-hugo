---
title: "タイムアウト設計"
date: 2021-01-08T15:58:12+09:00
slug: ""
tags:
- tag_name
draft: true
archives:
- 2019/06
---

処理タイムアウト、わからなくなるのでまとめる。

<!--more-->

# 必要性

- なぜ処理時間に上限を設けるのか？
    - 【サーバリソース観点】異常処理にリソースを占有されないため
    - 【監視観点】異常を検知するため
    - 【ユーザ観点】ユーザを待たせないため
    - 【整合性観点】更新系の場合は追い越しによる不整合が発生するのでその発生確率を下げるため

# 設計のポイント

- 【設定値】クライアントから奥に行くほど徐々にタイムアウト時間を短く設定する
    - フロント > ミドル > バックエンド
    - さもないと前段で結果を確認した上でハンドリングできない
- 【対象】タイムアウトの設定が必要なリソースは何か？（LB、マイクロサービス、DB、コネプ、外接など）
- 【タイムアウト後】中断・ロールバック・リトライなのか、冪等性はあるのか必要か、結果をどうハンドリング・通知するのか

<img src="https://cdn-ak.f.st-hatena.com/images/fotolife/y/yasuhiroa24/20200422/20200422171634.png" />